%******************************************************************************************************************************%
%******************************************************* `my-latex.sty' *******************************************************%
%******************************************************************************************************************************%
% Top level "super package" encapsulating the various component (sub)packages, each being responsible for a particular aspect/application, and providing access to the \documentclass and (sub)package options through corresponding 'my-latex' package options: adding "\RequirePackage[option list]{my-latex}" to a LaTeX document loads 'my-latex' and its component (sub)packages and the options specified in the "option list" are then forwarded to the relevant (sub)packages.  The package options corresponding to \documentclass and component package options are then applied directly, while those associated with lower level (sub)packages are propagated to the corresponding (sub)packages, either (1) directly as an explicit package option at the point where they're loaded or (2) indirectly through appropriate register variables (typically Booleans) and/or control sequence definitions. This hierarchal design is a convenient mechanism for providing centralized control over various options/settings and because the register variables and control sequences used to propagate package options have global scope, a low-level subpackage can access these directly without requiring they be passed explicitly through each level of the (sub)package hierarchy as additional package options.
%
% A similar structural scheme is used to provide centralized control over the behavior/appearance of content generated by various (sub)package macros/commands/environments, most notably environments containing 'tcolorbox' and/or 'tikz'/'pgf' content and the front/back matter content generated as part of the Table of Contents and associated glossary/acronym/symbol/index entry lists.  The corresponding register variables and general/universal macros, commands, and other global definitions/settings (e.g. those associated with lists, links, graphics/floats, etc.) used to control behavior/appearance are defined/implemented in the high-level 'my-definitions' component package.  Separating these from their application provides centralized control of nearly all settings/behavior/appearance through a single package, making it much easier to locate and modify the register variable or control sequence controlling the setting/property of interest, but it also improves the organizational scheme of the other (sub)packages.
%
% Note that the order in which the /documentclass related options/properties are applied and the order in which the component packages are loaded here is important; although there is some flexibility in this ordering, the dependencies between these component packages imposes a strict load order on most of these packages and this ordering should not be modified.  There are some unexpected dependencies on the 'my-glossaries' package which have yet to be identified but as long as the current ordering is maintained, this does not cause a problem.
%******************************************************************************************************************************%
%******************************** Define provided package name and LaTeX/package dependencies *********************************%
%******************************************************************************************************************************%
\NeedsTeXFormat{LaTeX2e}[2005/12/01]
\ProvidesPackage{my-latex}
\RequirePackage{pkgopts}                         % Defines two new "for" loop commands: \foreach and \breakforeach
%------------------------------------------------------------------------------------------------------------------------------%
\RequirePackageList{\@pkgopts@packages}
%\newtoggle{validated}
%******************************************************************************************************************************%
%************************************* Package options and corresponding Boolean variables ************************************%
%******************************************************************************************************************************%
%------------------------------------------------------------------------------------------------------------------------------%
\SetupKeyvalOptions{family=mylatex, prefix=mylatex@}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Package options and corresponding Boolean variables ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~%
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareBoolOption{report}
\DeclareBoolOption{article}%
\DeclareBoolOption{isorot}
\DeclareBoolOption[false]{countinchaps}
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareComplementaryOption{rotating}{isorot}
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareBoolOptionPair{crop}
\DeclareBoolOptionPair{landscape}
\DeclareBoolOptionPair[true]{standalone}
\DeclareBoolOptionPair[true]{coverpage}
\DeclareBoolOptionPair[true]{toc}
\DeclareBoolOptionPair[true]{frontbackmatter}
\DeclareBoolOptionPair[true]{automake}
\DeclareBoolOptionPair{fbmdotfill}
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareVoidOption{xindy}{\PassOptionsToPackage{xindy}{imakeidx}}
\DeclareVoidOption{texindy}{\PassOptionsToPackage{texindy}{imakeidx}}
\DeclareVoidOption{truexindy}{\PassOptionsToPackage{truexindy}{imakeidx}}
\DeclareVoidOption{makeindex}{\PassOptionsToPackage{makeindex}{imakeidx}}
\DeclareVoidOption{noautomatic}{\PassOptionsToPackage{noautomatic}{imakeidx}}
\DeclareVoidOption{nonewpage}{\PassOptionsToPackage{nonewpage}{imakeidx}}
\DeclareVoidOption{splitindex}{\PassOptionsToPackage{splitindex}{imakeidx}}
\DeclareVoidOption{original}{\PassOptionsToPackage{original}{imakeidx}}
\DeclareVoidOption{quiet}{\PassOptionsToPackage{quiet}{imakeidx}}
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareStringOption{documentclass}[report]
\DeclareStringOption[(OT1,lmr,m,n,10)]{font}[(OT1,lmr,m,n,10)]
%\DeclareStringOption[OT1]{fontencoding}[OT1]%\@known@font@encodings
%\DeclareStringOption[]{fontfamily}[]
\DeclareStringOption{fontfamily}[lmr]
%\DeclareStringOption[lmr]{fontfamily}[lmr]
%\DeclareStringOption[m]{fontseries}[m]
%\DeclareStringOption[n]{fontshape}[n]
\DeclareStringOption[10]{fontsize}[10]
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareChoiceOption{sizeXdoc}[10]{\@known@size@clo@defs}
\DeclareChoiceOption{fontencoding}[OT1]{\@known@font@encodings}
\DeclareChoiceOption{fontseries}[m]{\@known@font@series}
\DeclareChoiceOption{fontshape}[n]{\@known@font@shapes}
\DeclareChoiceOption{backpagenumbering}[roman]{\@supported@page@numbering}
\DeclareChoiceOption{fncychap}[Lenny]{\@supported@chaphead@styles}
\DeclareChoiceOption{choiceopttest}[choicetwo]{\choicetestoptions}
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareChoiceValOption{fontname}[Computer Modern Roman]{\@known@fontname@fontcode@pairs}
%\DeclareChoiceValOption{fontname}[Latin Modern Roman]{\@known@fontname@fontcode@pairs}
%\DeclareChoiceValOption[as]{fontname}[Computer Modern Roman]{\@known@fontname@fontcode@pairs}
%------------------------------------------------------------------------------------------------------------------------------%
\DeclareDefaultOption{\PackageWarning{my-latex}{Unknown \CurrentOption}}
%******************************************************************************************************************************%
%***************************************************** Processing of package options *****************************************************%
%******************************************************************************************************************************%
\ExecuteOptions{splitindex,nonewpage}
\ProcessPackageOptions
%------------------------------------------------------------------------------------------------------------------------------%
\ifmylatex@landscape
        \PassOptionsToClass{landscape}{article}
        \PassOptionsToClass{landscape}{report}
\fi
%------------------------------------------------------------------------------------------------------------------------------%
\ifmylatex@crop
        \PassOptionsToClass{crop}{article}
        \PassOptionsToClass{crop}{report}
\fi
%%------------------------------------------------------------------------------------------------------------------------------%
\SetDocFontSettings
\SetDocumentClass
%\SetDocFontSettings
%------------------------------------------------------------------------------------------------------------------------------%
\ifmylatex@automake
        \PassOptionsToPackage{automake}{my-glossaries}
\fi
%------------------------------------------------------------------------------------------------------------------------------%
\ifmylatex@fbmdotfill
        \newcommand*{\frontbackmatterhfill}{\fbm@dotfill}%
\else
        \newcommand*{\frontbackmatterhfill}{\fbm@nofill}%
\fi
%------------------------------------------------------------------------------------------------------------------------------%
%\ifdraft {draft case} {final case}
%\ifoptiondraft {option draft is given} {option draft is not given}
%\ifoptionfinal {option final is given} {option final is not given}
%******************************************************************************************************************************%
%************************************************************** Package Body *************************************************************%
%******************************************************************************************************************************%
%------------------------------------------------------------------------------------------------------------------------------%
%------------------------------------------------------------------------------------------------------------------------------%
%------------------------------------------------------------------------------------------------------------------------------%
\RequirePackage{imakeidx-patched}               % options: xindy
\RequirePackage{my-packages}                    % Custom set of packages used in my-latex.sty development
\RequirePackage{my-patches}                     % Contains package patches modifying/adding register variables and macros/commands/environments
\RequirePackage{my-colorsets}                   % Custom colorset definitions loaded
\RequirePackage{my-colors}                      % Custom color definitions and mixed color variables
\RequirePackage{my-color-schemes}               % Color set definitions (\colorlet}{<scheme name>Scheme-<property>) for tcb/tikz/etc. properties
\RequirePackage{my-definitions}                 % Custom set of packages used in my-latex.sty development
\RequirePackage{my-regvars}                     % Custom set of packages used in my-latex.sty development
%\RequirePackage{polynom}                     % Adapted 'polynom' package for polynomial long division, factoring, add/multiply/divide etc.
\RequirePackage{my-fonts}                       % Custom assignment of fonts and math alphabets to established and new font names
\RequirePackage{my-styles}                      % Custom color definition/naming and visual settings
\RequirePackage[acronym,toc,symbols]            % Adapatation of 'glossaries' for glossary/acronym/symbol entry lists w/ links to occurences
        {my-glossaries}                         % Options: automake, xindy/makeindex, section=chapter/(sub)section, nopostdot/main/nonumberlist
\RequirePackage[intoc]{my-nomencl}              % Nomenclature/abbreviations list similar to acronms/glossary
\RequirePackage{mainmatter}                %
\RequirePackage{frontbackmatter}                % Table of Contents, List of Tables/Figures/Acronyms/Symbols/Abbreviations, Index, Glossary etc.
\RequirePackage{my-math}                        % Custom math characters/symbols, delimiters, operators, (e/x/g)defs, commands, and environments
\RequirePackage{my-polynom}                     % Adapted 'polynom' package for polynomial long division, factoring, add/multiply/divide etc.
%\RequirePackage{polynom}                     % Adapted 'polynom' package for polynomial long division, factoring, add/multiply/divide etc.
\RequirePackage{my-lstautogobble}               % Adapted 'lstautogobble' package, automatically set 'listings' package's 'gobble=#' value
\RequirePackage{my-listings}                    % Adapted 'listings' package for configuring code listing languages/settings/appearance
%\RequirePackage{my-minted}                     % Adapted 'minted' package for configuring code listing languages/settings/appearance
\RequirePackage{my-macros}                      % Higher-level composite command/environment definitions combining lower-level components
\RequirePackage{my-graphics}                      % Higher-level composite command/environment definitions combining lower-level components
%------------------------------------------------------------------------------------------------------------------------------%
%******************************************************************************************************************************%
%******************************************** End of 'my-latex.sty' top level parent package *********************************************%
%******************************************************************************************************************************%
\catcode`!=\active
\catcode`\!=\active
\endinput 